# ПРОЕКТИРОВАНИЕ ФУНКЦИОНАЛЬНОЙ МОДЕЛИ НЕЙРОННОЙ СЕТИ


## Алгоритм вычисления выхода и обучения нейронной сети

Многослойная полносвязная нейронная сеть состоит из нескольких слоев, каждый из которых содержит некоторое количество нейронов.
Каждый нейрон имеет несколько входов и один выход. Каждый вход сети имеет вес. Значение выхода нейрона рассчитывается по формуле:

![изображение](https://user-images.githubusercontent.com/98205207/220164044-6b3a03e9-8471-4ec2-82e6-8379c781ae57.png)

где: f() – функция активации, y_i^k – выход i нейрона слоя k, n(k-1) –  количество нейронов в слое с номером (k-1), и w_ij^k – вес. Схема нейрона представлена ниже.

![изображение](https://user-images.githubusercontent.com/98205207/220164320-60e44f53-6ad7-4970-bca4-bb715176c700.png)

В данной работе будет использоваться сигмоидальная функция активации:

![изображение](https://user-images.githubusercontent.com/98205207/220164467-3f9c65d8-289b-401d-8924-5ca3482f1c84.png)

Выделяют входной, выходной и скрытые слои. Сеть может иметь несколько скрытых слоев. Схема многослойной полносвязной нейронной сети представлена ниже.

![изображение](https://user-images.githubusercontent.com/98205207/220164579-962c2232-90a3-4249-bb8b-88f503801be0.png)

Обучения нейронной сети включает следующие этапы:
Вычисление выхода сети; 
Вычисление ошибки функционирования по формуле:

![изображение](https://user-images.githubusercontent.com/98205207/220164707-1872f54d-eab7-4d66-8893-468695ddf827.png)

где: ti – ожидаемое значение выхода i сети, N – номер последнего слоя сети. 
Если ошибка больше заданного значения (в данной работе 0.001), то происходит подстройка весов по алгоритму обратного распространения ошибки. Проход по всем тестовым наборам называется эпохой обучения. Обучение останавливается, когда на всех тестовых наборах ошибка на выходе не превышает заданного значения.
Подстройка весов производится по формуле:

![изображение](https://user-images.githubusercontent.com/98205207/220164754-f7b31dba-fc0c-4c30-a61f-8358f4a7f5cb.png)

где: значение α – выбирается эмпирически в диапазоне от 0 до 1 и влияет на скорость минимизации ошибки обучения; Значение δ_i^k вычисляется по-разному для выходного слоя и внутренних слоев сети.
Для выходного слоя:

![изображение](https://user-images.githubusercontent.com/98205207/220164814-7e938aec-0b87-4e06-bb8b-e484d5eee08e.png)

Для внутренних слоев сети:

![изображение](https://user-images.githubusercontent.com/98205207/220164912-b188abe1-88ae-4fc9-b9bb-cb55a9162e73.png)

В результате работы полученной нейронной сети выводится ошибка на каждой эпохе и результат распознавания чисел из датасета emnist.

![изображение](https://user-images.githubusercontent.com/98205207/220165412-fdfcf0f3-b586-4a70-b2b5-48a8678594df.png)


